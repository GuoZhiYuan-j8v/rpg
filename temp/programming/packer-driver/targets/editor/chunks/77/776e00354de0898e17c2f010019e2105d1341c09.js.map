{"version":3,"sources":["file:///C:/Users/ffgdgrrr/Desktop/rpg/assets/tools/%E6%B5%B7%E9%BE%9F%E6%B1%A4/script/move.ts"],"names":["_decorator","Component","input","Input","KeyCode","Node","tween","v2","v3","Animation","tangmian","ccclass","property","move","distance","isMove","word","event","moveDistance","moveDirection","onLoad","on","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestroy","off","keyCode","KEY_A","KEY_D","KEY_W","KEY_S","KEY_Z","checkPosIsWord","enterWord","movePlayer","x","y","node","call","by","position","setTimeout","console","log","start","tangmianScript","getComponent","i","children","length","startPos","endPos","play","worldPosition","Math","floor","name"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventKeyboard, find, input, Input, KeyCode, Node, tween, v2, v3, Vec2 } from 'cc';\r\nimport { tangmian } from './tangmian';\r\nimport { Label } from 'cc';\r\nimport { color } from 'cc';\r\nimport { Animation } from 'cc';\r\nimport { Vec3 } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n@ccclass('move')\r\nexport class move extends Component {\r\n    distance:Vec2=v2(0,0)\r\n    @property(Node)\r\n    tangmian:Node=null!;\r\n    isMove: boolean=false\r\n    word:Node;\r\n    event:Map<string,[number,number]>;\r\n    private moveDistance: number = 40; // 移动距离\r\n\r\n    private moveDirection: Vec3 = v3(0, 0, 0); // 移动方向\r\n\r\n    onLoad() {\r\n        input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        input.on(Input.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    onDestroy() {\r\n        input.off(Input.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        input.off(Input.EventType.KEY_UP, this.onKeyUp, this);\r\n    }\r\n\r\n    onKeyDown(event: EventKeyboard) {\r\n        switch (event.keyCode) {\r\n            case KeyCode.KEY_A:\r\n                this.moveDirection = v3(-1,0);\r\n                break;\r\n            case KeyCode.KEY_D:\r\n                this.moveDirection=v3(1,0);\r\n                break;\r\n            case KeyCode.KEY_W:\r\n                this.moveDirection=v3(0,1);\r\n                break;\r\n            case KeyCode.KEY_S:\r\n                this.moveDirection=v3(0,-1);\r\n                break;\r\n            case KeyCode.KEY_Z:\r\n                this.checkPosIsWord()\r\n                this.enterWord()\r\n                break\r\n        }\r\n        if(this.isMove==false){\r\n            this.movePlayer();\r\n        }\r\n        \r\n    }\r\n\r\n    onKeyUp(event: EventKeyboard) {\r\n        switch (event.keyCode) {\r\n            case KeyCode.KEY_A:\r\n            case KeyCode.KEY_D:\r\n                this.moveDirection.x = 0;\r\n                break;\r\n            case KeyCode.KEY_W:\r\n            case KeyCode.KEY_S:\r\n                this.moveDirection.y = 0;\r\n                break;\r\n        }\r\n    }\r\n\r\n    movePlayer() {\r\n        tween(this.node)\r\n        .call(()=>{\r\n            this.isMove=true\r\n        })\r\n            .by(0.2, { position: v3(this.moveDirection.x*this.moveDistance,this.moveDirection.y*this.moveDistance) })\r\n            .call(() => {\r\n                this.isMove=false\r\n                if (this.moveDirection.x !== 0 || this.moveDirection.y !== 0) {\r\n                    setTimeout(() => {\r\n                       this.movePlayer() \r\n                    }, 0); \r\n                    console.log('666')\r\n                }\r\n            })\r\n            .start();\r\n    }\r\n    enterWord(){\r\n        let tangmianScript=this.word.getComponent(tangmian)\r\n        for(let i=0;i<this.tangmian.children.length;i++){\r\n            if(i>=tangmianScript.startPos&&i<tangmianScript.endPos){\r\n                this.tangmian.children[i].getComponent(Animation).play()\r\n            }\r\n        }\r\n        \r\n    }\r\n    checkPosIsWord(){\r\n        for(let i=0;i<this.tangmian.children.length;i++){\r\n            console.log(this.node.worldPosition,this.tangmian.children[i].worldPosition,'对比')\r\n            if(this.tangmian.children[i].worldPosition.x==this.node.worldPosition.x&&Math.floor(this.tangmian.children[i].worldPosition.y)==Math.floor(this.node.worldPosition.y)){\r\n                console.log(\"是这个字\"+this.tangmian.children[i].name)\r\n                this.word=this.tangmian.children[i]\r\n                \r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n"]}