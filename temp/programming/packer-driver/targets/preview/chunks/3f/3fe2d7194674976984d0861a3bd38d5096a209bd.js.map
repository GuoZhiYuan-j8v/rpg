{"version":3,"sources":["file:///C:/Users/ffgdgrrr/Desktop/rpg/assets/UI/settingData.ts"],"names":["_decorator","Component","Director","director","find","input","Input","instantiate","Prefab","sys","stateUI","ccclass","property","StateType","settingData","金钱","心情","睡眠","饱食","理智","NodeData","Map","saveScene","instantiateLoading","loadScene","sceneName","console","log","getScene","name","localStorage","getItem","sceneData","JSON","parse","forEach","value","key","node","getPathInHierarchy","position","active","syncDeletedNodes","currentSceneNodes","root","traverseNodeForSync","has","nodeToDelete","nodeMap","set","children","i","length","traverseNode","start","setItem","stringify","schedule","changeStateValue","instantiateBag","instantiateStateUI","addPersistRootNode","currentScene","onLoad","on","EVENT_BEFORE_SCENE_LOADING","EVENT_AFTER_SCENE_LAUNCH","EventType","KEY_DOWN","onKeyDown","saveOrRead","setParent","camera","setPosition","x","y","bagNode","bag","sceneContorl","SceneContorl","loadingNode","Loading","StateUINode","StateUI","type","状态UI","getComponent","progress","人民币","string","scheduleOnce","openState","currentSceneName","autoSave","onDestroy","off","event","keyCode","parseInt","sr","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Director, director, Enum, EventKeyboard, find, input, Input, instantiate, Node, Prefab, Sprite, sys } from 'cc';\r\nimport { Vec3 } from 'cc';\r\nimport { stateUI } from '../tools/状态栏/stateUI';\r\nimport { bag } from '../tools/inventory/script/bag';\r\nconst { ccclass, property } = _decorator;\r\nexport enum StateType{\r\n    心情,\r\n    睡眠,\r\n    饱食,\r\n    理智,\r\n    金钱,\r\n}\r\n\r\n\r\n@ccclass('settingData')\r\nexport class settingData extends Component {\r\n    @property(Prefab)\r\n    SceneContorl:Prefab=null\r\n    @property(Prefab)\r\n    saveOrRead:Prefab=null!\r\n    金钱:number=0\r\n    心情:number=50\r\n    睡眠:number=50\r\n    饱食:number=50\r\n    理智:number=100\r\n    @property(Prefab)\r\n    Loading:Prefab=null!\r\n    @property(Prefab)\r\n    StateUI:Prefab=null!\r\n    @property(Prefab)\r\n    bag:Prefab=null!\r\n    NodeData:Map<string, [Vec3, boolean]> = new Map();\r\n\r\n    saveScene() {\r\n        \r\n        this.instantiateLoading()\r\n    }\r\n    loadScene(sceneName: string) {\r\n        console.log(sceneName);\r\n        if (director.getScene().name === sceneName) {\r\n            if (sys.localStorage.getItem(sceneName)) {\r\n                console.log('loadScene', sceneName);\r\n                let sceneData: Map<string, [Vec3, boolean]> = new Map(JSON.parse(sys.localStorage.getItem(sceneName)));\r\n                sceneData.forEach((value, key: string) => {\r\n                    let node = find(key);\r\n                    if (node) {\r\n                        if(node.getPathInHierarchy()!='Canvas/2.5d/Player/!'){\r\n                            node.position = value[0];\r\n                        node.active = value[1];\r\n                        }\r\n                        \r\n                    }\r\n                });\r\n    \r\n                // 检查删除的节点信息并同步操作\r\n                this.syncDeletedNodes(sceneData);\r\n            }\r\n        }\r\n    }\r\n    syncDeletedNodes(sceneData: Map<string, [Vec3, boolean]>) {\r\n        // 通过比较保存的节点信息和当前场景节点信息来检查删除的节点\r\n        let currentSceneNodes = new Map();\r\n        let root = find('Canvas');\r\n        this.traverseNodeForSync(root, currentSceneNodes);\r\n    \r\n        // 检查在保存的场景中不存在，但在当前场景中存在的节点，并进行同步删除操作\r\n        currentSceneNodes.forEach((value, key: string) => {\r\n            if (!sceneData.has(key)) {\r\n                // 节点在保存的场景中不存在，但在当前场景中存在，进行同步删除操作\r\n                let nodeToDelete = find(key);\r\n                if (nodeToDelete) {\r\n                    nodeToDelete.active=false\r\n                }\r\n            }\r\n        });\r\n    }\r\n    \r\n    \r\n    traverseNodeForSync(node: Node, nodeMap: Map<string, boolean>) {\r\n        if (node) {\r\n            nodeMap.set(node.getPathInHierarchy(), true);\r\n            let children = node.children;\r\n            for (let i = 0; i < children.length; i++) {\r\n                this.traverseNodeForSync(children[i], nodeMap);\r\n            }\r\n        }\r\n    }\r\n    traverseNode(node: Node) {\r\n        if (node) {\r\n            this.NodeData.set(node.getPathInHierarchy(), [node.position, node.active]);\r\n            let children = node.children;\r\n            for (let i = 0; i < children.length; i++) {\r\n                this.traverseNode(children[i]);\r\n            }\r\n        }\r\n    }\r\n    start() {\r\n        \r\n        if(sys.localStorage.getItem('金钱')){\r\n            this.金钱=JSON.parse(sys.localStorage.getItem('金钱'))\r\n        }else{\r\n            sys.localStorage.setItem('金钱',JSON.stringify(this.金钱))\r\n        }\r\n        if(sys.localStorage.getItem('心情')){\r\n            this.心情=JSON.parse(sys.localStorage.getItem('心情'))\r\n            console.log(sys.localStorage.getItem('心情'))\r\n        }else{\r\n            sys.localStorage.setItem('心情',JSON.stringify(this.心情))\r\n        }\r\n        if(sys.localStorage.getItem('理智')){\r\n            this.理智=JSON.parse(sys.localStorage.getItem('理智'))\r\n        }else{\r\n            sys.localStorage.setItem('理智',JSON.stringify(this.理智))\r\n        }\r\n        if(sys.localStorage.getItem('睡眠')){\r\n            this.睡眠=JSON.parse(sys.localStorage.getItem('睡眠'))\r\n        }else{\r\n            sys.localStorage.setItem('睡眠',JSON.stringify(this.睡眠))\r\n        }\r\n        if(sys.localStorage.getItem('饱食')){\r\n            this.饱食=JSON.parse(sys.localStorage.getItem('饱食'))\r\n        }else{\r\n            sys.localStorage.setItem('饱食',JSON.stringify(this.饱食))\r\n        }\r\n        \r\n        this.schedule(()=>{\r\n            this.changeStateValue(StateType.睡眠,-1)\r\n            this.changeStateValue(StateType.饱食,-3)\r\n            console.log(this.饱食,'dududu')\r\n        },15)\r\n        this.changeStateValue(StateType.心情,0)\r\n        this.instantiateBag()\r\n        this.instantiateStateUI()\r\n        director.addPersistRootNode(this.node)\r\n        this.currentScene()\r\n    }\r\n    onLoad () {\r\n        director.on(Director.EVENT_BEFORE_SCENE_LOADING,this.saveScene,this)\r\n        director.on(Director.EVENT_AFTER_SCENE_LAUNCH,this.currentScene,this)\r\n        input.on(Input.EventType.KEY_DOWN, this.onKeyDown, this);\r\n    }\r\n    instantiateBag(){\r\n        let saveOrRead=instantiate(this.saveOrRead)\r\n        saveOrRead.setParent(find('Canvas'))\r\n        let camera=find('Canvas/Camera')\r\n        saveOrRead.setPosition(camera.position.x,camera.position.y)\r\n        let bagNode=instantiate(this.bag)\r\n        bagNode.setParent(find('Canvas/Camera'))\r\n        bagNode.setPosition(0,256)\r\n        bagNode.active=false\r\n        let sceneContorl=instantiate(this.SceneContorl)\r\n        sceneContorl.setParent(find('Canvas'))\r\n        sceneContorl.setPosition(0,-450)\r\n\r\n        \r\n        //bagNode.getComponent(bag).add('foodCard')\r\n    }\r\n    instantiateLoading(){\r\n        let loadingNode=instantiate(this.Loading)\r\n        loadingNode.setParent(find('Canvas/Camera'))\r\n        loadingNode.setPosition(0,0)\r\n        //bagNode.getComponent(bag).add('foodCard')\r\n    }\r\n    instantiateStateUI(){\r\n        let StateUINode=instantiate(this.StateUI)\r\n        StateUINode.setParent(find('Canvas/Camera'))\r\n        StateUINode.setPosition(-619,318)\r\n    }\r\n    changeStateValue(type:StateType,value:number){\r\n        switch(type){\r\n            case StateType.心情:\r\n                if(this.心情>0&&this.心情<=100){\r\n                    this.心情+=value\r\n                }\r\n                if(this.心情<=0){\r\n                    this.心情=1\r\n                }else if(this.心情>100){\r\n                    this.心情=100\r\n                }\r\n                break\r\n            case StateType.理智:\r\n                if(this.理智>0&&this.理智<=100){\r\n                    this.理智+=value\r\n                }\r\n                if(this.理智<=0){\r\n                    this.理智=1\r\n                }else if(this.理智>100){\r\n                    this.理智=100\r\n                }\r\n                break\r\n            case StateType.睡眠:\r\n                if(this.睡眠>0&&this.睡眠<=100){\r\n                    this.睡眠+=value\r\n                }\r\n                if(this.睡眠<=0){\r\n                    this.睡眠=1\r\n                }else if(this.睡眠>100){\r\n                    this.睡眠=100\r\n                }\r\n                break\r\n            case StateType.饱食:\r\n                if(this.饱食>0&&this.饱食<=100){\r\n                    this.饱食+=value\r\n                }\r\n                if(this.饱食<=0){\r\n                    this.饱食=1\r\n                }else if(this.饱食>100){\r\n                    this.饱食=100\r\n                }\r\n                break\r\n            case StateType.金钱:\r\n                this.金钱+=value\r\n                break\r\n        }\r\n        \r\n        if(find('Canvas/Camera/状态UI')){\r\n            let 状态UI=find('Canvas/Camera/状态UI').getComponent(stateUI)\r\n        console.log(状态UI)\r\n        状态UI.心情.progress=this.心情/100\r\n        状态UI.理智.progress=this.理智/100\r\n        状态UI.睡眠.progress=this.睡眠/100\r\n        状态UI.饱食.progress=this.饱食/100\r\n        状态UI.人民币.string='人民币：'+this.金钱+'元'\r\n        }\r\n        sys.localStorage.setItem('心情',JSON.stringify(this.心情))\r\n        sys.localStorage.setItem('理智',JSON.stringify(this.理智))\r\n        sys.localStorage.setItem('睡眠',JSON.stringify(this.睡眠))\r\n        sys.localStorage.setItem('饱食',JSON.stringify(this.饱食))\r\n        sys.localStorage.setItem('金钱',JSON.stringify(this.金钱))\r\n        console.log(this.饱食)\r\n       \r\n\r\n    }\r\n    currentScene(){\r\n        // this.心情=JSON.parse(sys.localStorage.getItem('心情'))\r\n        // this.理智=JSON.parse(sys.localStorage.getItem('理智'))\r\n        // this.睡眠=JSON.parse(sys.localStorage.getItem('睡眠'))\r\n        // this.饱食=JSON.parse(sys.localStorage.getItem('饱食'))\r\n        this.scheduleOnce(()=>{\r\n            this.changeStateValue(StateType.心情,0)\r\n        },1)\r\n        if (sys.localStorage.getItem('openState')) {\r\n        const openState:boolean=JSON.parse(sys.localStorage.getItem('openState'))\r\n        if(openState==true){\r\n            this.instantiateStateUI()\r\n        }\r\n    }\r\n        this.instantiateBag()\r\n        const currentScene = director.getScene();\r\n        const currentSceneName = currentScene?.name;\r\n        if(currentSceneName!='End'&&currentSceneName!='setting'&&currentSceneName!='startMenu'){\r\n            sys.localStorage.setItem('currentScene',currentSceneName)\r\n            const autoSave:boolean=JSON.parse(sys.localStorage.getItem('autoSave'))\r\n            if(autoSave==true){\r\n                sys.localStorage.setItem('SaveScene',currentSceneName)\r\n            }\r\n        } \r\n        console.log(currentSceneName)\r\n            console.log(this.node.name+sys.localStorage.getItem('currentScene'))\r\n    }\r\n    onDestroy () {\r\n        director.off(Director.EVENT_BEFORE_SCENE_LOADING,this.saveScene,this)\r\n        director.off(Director.EVENT_AFTER_SCENE_LAUNCH,this.currentScene,this)\r\n        input.off(Input.EventType.KEY_DOWN, this.onKeyDown, this);\r\n    }\r\n    onKeyDown (event: EventKeyboard) {\r\n        switch(event.keyCode) {\r\n            case parseInt(sys.localStorage.getItem('esc')):\r\n                director.loadScene('setting')\r\n                break\r\n            case parseInt(sys.localStorage.getItem('save')):\r\n               \r\n                let sr=find('Canvas/readAndSaveNode')\r\n                if(sr.active==true){\r\n                    sr.active=false\r\n                }else if(sr.active==false){\r\n                    sr.active=true\r\n                    let camera=find('Canvas/Camera')\r\n                    sr.setPosition(camera.position.x,camera.position.y)\r\n                }\r\n                //sys.localStorage.setItem('SaveScene',director.getScene().name)\r\n                break\r\n            case parseInt(sys.localStorage.getItem('inventory')):\r\n                if(find('Canvas/Camera/bag').active==false){\r\n                    find('Canvas/Camera/bag').active=true\r\n                }else if(find('Canvas/Camera/bag').active==true){\r\n                    console.log('asd')\r\n                    find('Canvas/Camera/bag').active=false\r\n                    console.log(find('Canvas/Camera/bag'))\r\n                }\r\n                \r\n                break\r\n        }        \r\n    }\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n}\r\n\r\n\r\n"]}