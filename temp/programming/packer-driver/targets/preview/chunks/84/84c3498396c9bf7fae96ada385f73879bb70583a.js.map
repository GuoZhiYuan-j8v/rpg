{"version":3,"sources":["file:///C:/Users/ffgdgrrr/Desktop/rpg/assets/tools/%E6%B5%B7%E9%BE%9F%E6%B1%A4/script/wordContorl.ts"],"names":["instantiate","Label","Prefab","_decorator","Component","Node","UITransform","color","director","CCString","move","tangmian","ccclass","property","wordContorl","type","nowIndex","once","wordArray","start","generateWord","addEvent","j","i","texts","length","push","forEach","element","word","name","getComponent","string","setParent","node","Player","distance","x","contentSize","y","addEventFunc","end","tag","console","log","children","tangmianScript","startPos","endPos","caseFunc","loadScene","count","quotesPositions","concat","split","tempArray","index","update","deltaTime"],"mappings":"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","sourcesContent":["import { instantiate } from 'cc';\r\nimport { Label } from 'cc';\r\nimport { Prefab } from 'cc';\r\nimport { _decorator, Component, Node } from 'cc';\r\nimport { move } from './move';\r\nimport { UITransform } from 'cc';\r\nimport { color } from 'cc';\r\nimport { tangmian } from './tangmian';\r\nimport { find } from 'cc';\r\nimport { director } from 'cc';\r\nimport { CCString } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n\r\n@ccclass('wordContorl')\r\nexport class wordContorl extends Component {\r\n    nowIndex:number=0\r\n    once:boolean=true\r\n    @property(Node)\r\n    Player:Node=null!\r\n    @property({type:CCString})\r\n    texts:String[]=[]\r\n    @property(Prefab)\r\n    word:Prefab=null!\r\n    wordArray:string[]=[]\r\n    start() {\r\n        \r\n        this.generateWord()\r\n        this.addEvent()\r\n    }\r\n\r\n    generateWord(){\r\n        let wordArray:string[]=[]\r\n        for(let j=0;j<this.nowIndex+1;j++){\r\n        for(let i=0;i<this.texts[j].length;i++){\r\n            if(this.texts[j][i]=='\"'){\r\n            }else{\r\n                wordArray.push(this.texts[j][i])\r\n            }\r\n        }\r\n    }\r\n        wordArray.forEach(element=>{\r\n            let word=instantiate(this.word)\r\n            word.name=element\r\n            word.getComponent(Label).string=element\r\n            word.setParent(this.node)\r\n            if(this.once==true){\r\n                this.Player.getComponent(move).distance.x=word.getComponent(UITransform).contentSize.x\r\n                this.Player.getComponent(move).distance.y=word.getComponent(UITransform).contentSize.y\r\n                this.once=false\r\n            }\r\n            \r\n        })\r\n        this.wordArray=wordArray\r\n    }\r\n    addEvent(){\r\n        let addEventFunc=(start:number,end:number,tag:string)=>{\r\n            console.log(tag)\r\n            let wordArray:string[]=[]\r\n            wordArray=this.wordArray\r\n        for(let i=0;i<wordArray.length;i++){\r\n            if(i>=start&&i<end){\r\n                this.node.children[i].getComponent(Label).color=color(255,0,0,255)\r\n                let tangmianScript=this.node.children[i].getComponent(tangmian)\r\n                tangmianScript.startPos=start\r\n                tangmianScript.endPos=end\r\n                tangmianScript.tag=tag\r\n                switch(tag){\r\n                    case \"举报\":\r\n                        tangmianScript.caseFunc=()=>{\r\n                            director.loadScene('ThrowQuestion_举报')\r\n                        }\r\n                        break\r\n                    case \"ｘｐ\":\r\n                        tangmianScript.caseFunc=()=>{\r\n                            director.loadScene('ThrowQuestion_ｘｐ')\r\n                        }\r\n                        break\r\n                }\r\n            }\r\n        }\r\n        }\r\n        let count = 0;\r\n        let quotesPositions:number[][] = []; // 最终的数组，存储每对引号的位置\r\n    let texts:string[]=[]\r\nfor (let i = 0; i < this.nowIndex + 1; i++) {\r\n    texts=texts.concat(this.texts[i].split(''));\r\n    console.log(texts)\r\n}\r\nconsole.log((texts+'texts'))\r\n    let tempArray:number[] = []; // 临时数组，存储当前字符串中每对引号的位置\r\n    texts.forEach((element, index) => {\r\n        if (element == '\"') {\r\n            console.log('找到第' + (index - count) + '个位置的\"');\r\n            tempArray.push(index - count); // 记录引号的位置\r\n            count++;\r\n        }\r\n        if (tempArray.length === 2) {\r\n            let tag=''\r\n            console.log(this.wordArray)\r\n            this.wordArray.forEach((element,index)=>{\r\n                if(index>=tempArray[0]&&index<tempArray[1]){\r\n                    tag+=element\r\n                }\r\n            })\r\n            quotesPositions.push(tempArray);\r\n            addEventFunc(tempArray[0],tempArray[1],tag)\r\n            tempArray.length=0\r\n        }\r\n    });\r\n    // 检查临时数组中是否有两个位置，如果有则添加到最终数组中\r\n    \r\nconsole.log(quotesPositions,\"位置\")\r\n        \r\n        // while (true) {\r\n        //     start = s.indexOf('\"', start);\r\n        //     if (start === -1) {\r\n        //         break;\r\n        //     }\r\n        //     const end: number = s.indexOf('\"', start + 1);\r\n        //     if (end === -1) {\r\n        //         break;\r\n        //     }\r\n        //     const content: string = s.substring(start + 1, end);\r\n        //     console.log(`被\"\"包裹的内容是：${content}，起始位置为：${start}，结束位置为：${end-2}`);\r\n        //     addEventFunc(start,end-2,content)\r\n        //     start = end + 1;\r\n        // }\r\n\r\n        \r\n        // let moveScript=this.Player.getComponent(move)\r\n        // moveScript.event.set(tag,[start,end])\r\n    }\r\n    update(deltaTime: number) {\r\n        \r\n    }\r\n}\r\n\r\n\r\n"]}