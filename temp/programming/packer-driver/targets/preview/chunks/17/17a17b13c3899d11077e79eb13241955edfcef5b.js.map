{"version":3,"sources":["file:///C:/Users/ffgdgrrr/Desktop/rpg/assets/tools/inventory/script/bag.ts"],"names":["sys","UITransform","_decorator","Component","Prefab","resources","instantiate","find","ccclass","property","bag","lnventory","start","load","update","deltaTime","traverseChildren","add","InResourcesName","console","log","err","res","prefab","setParent","node","name","children","length","getComponent","width","alignHorizontal","forEach","element","index","setPosition","checkHas","meziName","count","foundCount","delete","childrenName","parentPath","func","child","destroy","onDestroy","i","push","localStorage","setItem","JSON","stringify","setDefultPos","parent","getItem","Object","assign","Array","parse"],"mappings":"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","sourcesContent":["import { sys, UITransform } from 'cc';\r\nimport { _decorator, Component, Node, Prefab, resources, instantiate, find } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('bag')\r\nexport class bag extends Component {\r\n\r\n    lnventory: string[] = []\r\n    start() {\r\n        this.load()\r\n    }\r\n\r\n    update(deltaTime: number) {\r\n        this.traverseChildren()\r\n    }\r\n    add(InResourcesName: string) {\r\n        console.log(InResourcesName)\r\n        resources.load('mezi/' + InResourcesName, Prefab, (err, res) => {\r\n            console.log(err)\r\n            let prefab = instantiate(res)\r\n            prefab.setParent(this.node)\r\n            console.log(prefab.name)\r\n            if (this.node.children.length > 7) {\r\n                this.node.getComponent(UITransform).width = this.node.children.length * 128 + 64\r\n            }\r\n\r\n        })\r\n    }\r\n    alignHorizontal() {\r\n        this.node.children.forEach((element, index) => {\r\n            element.setPosition(index * 128 + 64, 0, 0)\r\n        })\r\n    }\r\n    checkHas(meziName: string, count: number = 1): boolean {\r\n        let foundCount = 0; // 用于计数找到的物品数量\r\n        this.lnventory.forEach(element => {\r\n            if (meziName === element) {\r\n                foundCount++; // 发现一个匹配的物品，计数加一\r\n            }\r\n        });\r\n        return foundCount >= count; // 检查找到的数量是否满足最小数量要求\r\n    }\r\n    delete(childrenName: string, parentPath?: string, func?: Function) {\r\n        for (let child of this.node.children) {\r\n            if (child.name == childrenName) {\r\n                if (parentPath) {\r\n                    child.setParent(find(parentPath))\r\n                    find(parentPath + '/' + childrenName).setPosition(0, 0, 0)\r\n                } else {\r\n                    child.destroy()\r\n                }\r\n                break\r\n            }\r\n        }\r\n        console.log(this.node.children.length)\r\n    }\r\n    onDestroy() {\r\n\r\n    }\r\n    traverseChildren() {\r\n        this.lnventory = []\r\n        if (this.node.children.length != 0) {\r\n            for (let i = 0; i < this.node.children.length; i++) {\r\n                this.lnventory.push(this.node.children[i].name)\r\n            }\r\n        }\r\n      \r\n        sys.localStorage.setItem('lnventory', JSON.stringify(this.lnventory))\r\n    }\r\n    setDefultPos() {\r\n        for (let children of this.node.children) {\r\n            children.setParent(this.node.parent)\r\n            children.setParent(this.node)\r\n        }\r\n    }\r\n    load() {\r\n        if (sys.localStorage.getItem('lnventory')) {\r\n            let lnventory: string[] = Object.assign(new Array(), JSON.parse(sys.localStorage.getItem('lnventory')))\r\n            console.log(lnventory)\r\n            for (let i = 0; i < lnventory.length; i++) {\r\n                this.add(lnventory[i])\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n\r\n\r\n"]}